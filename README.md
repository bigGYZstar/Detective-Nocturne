# 探偵ノクターン -銀の黄昏とアザゼルの鍵-

## 🎮 ゲーム概要

**探偵ノクターン -銀の黄昏とアザゼルの鍵-** は、Godot 4.5エンジンで開発された18禁ビジュアルノベル・アドベンチャーゲームです。

### 基本情報
- **ジャンル**: ビジュアルノベル・アドベンチャーゲーム
- **対象年齢**: 18歳以上
- **プラットフォーム**: PC (Windows/Mac/Linux)
- **エンジン**: Godot 4.5
- **開発段階**: データ駆動シナリオ実装 v0.2

### ストーリー
探偵の水島みずきと助手の田村沙織が、一条瑠璃からの依頼を受けて行方不明になった父親を探す物語。『銀の黄昏会』という謎の宗教団体と『アザゼルの鍵』という古い遺物を巡る、深い人間ドラマが展開されます。

## 🚀 セットアップ

### 必要環境
- **Godot Engine**: 4.5以上
- **OS**: Windows 10/11, macOS 10.15+, Ubuntu 20.04+
- **メモリ**: 4GB RAM以上
- **ストレージ**: 2GB以上の空き容量

### インストール手順

1. **リポジトリのクローン**
```bash
git clone https://github.com/bigGYZstar/Detective-Nocturne.git
cd Detective-Nocturne
```

2. **Godotエンジンのダウンロード**
```bash
# Linux版の場合
wget https://github.com/godotengine/godot/releases/download/4.5-stable/Godot_v4.5-stable_linux.x86_64.zip
unzip Godot_v4.5-stable_linux.x86_64.zip
chmod +x Godot_v4.5-stable_linux.x86_64
```

3. **プロジェクトのインポート**
```bash
# ヘッドレスモードでプロジェクトをインポート
./Godot_v4.5-stable_linux.x86_64 --headless --quit --path . --import
```

4. **ゲームの実行**
```bash
# エディタで開く
./Godot_v4.5-stable_linux.x86_64 --path .

# 直接実行（エクスポート後）
./Godot_v4.5-stable_linux.x86_64 --headless --path . --main-pack game.pck
```

## 🎯 現在の実装状況（v0.2）

### ✅ 実装済み機能
- **データ駆動シナリオシステム**: シナリオデータがJSONファイルに一元化され、Godotエンジンから独立して管理されます。
- **アセット管理**: `manifest.json`を介したアセット参照により、パス直書きを排除。
- **基本UI**: ダイアログシステム、メニューシステム
- **キャラクター表示**: 主要3キャラクターの立ち絵（通常、驚き、悲しみなどの表情差分を含む）
- **シナリオシステム**: 序章および第二章のデータ駆動型シナリオ実装
- **ゲーム管理**: 状態管理、フラグ管理、好感度システム
- **設定システム**: 音量調整、テキスト速度、フルスクリーン
- **セーブ・ロード**: 10スロット対応のセーブシステム（行ID基準での復元に対応）
- **既読・スキップ・ジャンプ**: 行ID基準での動作に対応
- **シナリオデータバリデーション**: 重複ID、未解決参照、未定義ジャンプ、言語欠落の検出機能

### 🔄 開発中機能
- 音声・BGMシステム
- CG鑑賞モード
- 全章のシナリオ実装
- 18禁シーンの詳細実装
- エフェクト・演出システム

## 📖 データ駆動シナリオシステム

本プロジェクトでは、シナリオの管理をデータ駆動型に移行しました。これにより、以下のメリットが実現されます。

- **セーブ互換性**: シナリオの各コマンドに一意のIDを付与することで、セーブデータの互換性を高め、将来のシナリオ変更にも柔軟に対応できます。
- **既読制御**: 各コマンドの既読状態を行IDで管理し、既読スキップや未読停止を正確に制御します。
- **翻訳拡張**: `text`フィールドを多言語辞書形式で保持することで、将来的な多言語対応が容易になります。
- **演出差し替えの耐性**: シナリオロジックと表示ロジックを分離することで、演出の変更がシナリオデータに影響を与えにくくなります。
- **章追加の効率化**: 新しい章の追加は、対応するJSONファイルを`data/scenarios`ディレクトリに配置するだけで可能になります。

### データ構造

- **章データ**: `data/scenarios/<chapter>.json`
  - 各章のシナリオコマンドをJSON形式で格納。各コマンドは一意の`id`を持つ。
- **アセット辞書**: `data/assets/manifest.json`
  - キャラクター画像、背景画像、UI要素などのアセットパスをキー参照で一元管理。コードからのパス直書きを排除。

## 🏗️ プロジェクト構造

```
Detective-Nocturne/
├── project.godot              # Godotプロジェクト設定
├── scenes/                    # シーンファイル
│   ├── Main.tscn             # メインシーン
│   ├── ui/                   # UIシーン
│   ├── characters/           # キャラクターシーン
│   └── backgrounds/          # 背景シーン
├── scripts/                   # スクリプトファイル
│   ├── GameManager.gd        # ゲーム全体管理
│   ├── DialogSystem.gd       # ダイアログシステム
│   ├── CharacterManager.gd   # キャラクター管理
│   ├── ScenarioManager.gd    # シナリオ管理 (データ駆動型)
│   ├── SaveSystem.gd         # セーブ・ロード
│   └── SettingsSystem.gd     # 設定システム
├── assets/                    # アセットファイル
│   ├── images/               # 画像ファイル
│   │   ├── characters/       # キャラクター画像
│   │   ├── backgrounds/      # 背景画像
│   │   └── ui/              # UI画像
│   ├── audio/               # 音声ファイル
│   │   ├── bgm/             # BGM
│   │   ├── se/              # 効果音
│   │   └── voice/           # ボイス
│   └── fonts/               # フォントファイル
└── data/                     # データファイル
    ├── scenarios/            # シナリオデータ (.json)
    ├── assets/               # アセットマニフェスト
    │   └── manifest.json     # アセットパス定義
    └── saves/               # セーブデータ
```

## 🎮 操作方法

### 基本操作
- **テキスト送り**: マウスクリック / スペースキー / エンターキー
- **メニュー表示**: ESCキー
- **ダイアログボックス切り替**: 右クリック（実装予定）

### ゲーム機能
- **セーブ・ロード**: メニューからアクセス
- **設定**: 音量、テキスト速度、画面モードの調整
- **バックログ**: 過去の会話履歴表示（実装予定）
- **スキップ**: 既読テキストの高速スキップ（実装済み）

## 🎭 キャラクター

### 主要キャラクター

#### 水島みずき（探偵）
- 冷静沈着で理性的な女性探偵
- 黒髪ショート、クールな美人
- プレイヤーの分身として物語を進行
- 表情差分: 通常、驚き、悲しみ

#### 田村沙織（探偵助手）
- 優しく上品な性格の助手
- 茶髪ロング、清楚な印象
- みずきをサポートし、物語に安定感を与える
- 表情差分: 通常、驚き、悲しみ

#### 一条瑠璃（依頼人）
- 行方不明の父親を探す依頼人
- 銀髪ロング、透明感のある美少女
- 物語の鍵を握る重要人物
- 表情差分: 通常、驚き、悲しみ

## 🔧 開発情報

### 技術仕様
- **エンジン**: Godot 4.5
- **言語**: GDScript
- **解像度**: 1920x1080 (16:9)
- **レンダラー**: Vulkan (Forward+)
- **オーディオ**: OGG Vorbis形式
- **画像**: PNG形式

### 開発環境
- **OS**: Ubuntu 22.04
- **Godot**: 4.5-stable
- **Git**: バージョン管理
- **GitHub**: リポジトリホスティング

## 📝 ライセンス

このプロジェクトは開発中のため、現在ライセンスは未定です。

## 🤝 コントリビューション

現在このプロジェクトは個人開発中のため、外部からのコントリビューションは受け付けていません。

## 📞 サポート

バグ報告や質問については、GitHubのIssuesをご利用ください。

---

**注意**: このゲームは18歳以上を対象とした成人向けコンテンツを含みます。

